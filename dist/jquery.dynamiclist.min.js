!function(t){var e={addItem:function(n,a){n&&n.preventDefault(),a.addButton.prop("disabled",!0);var i=e.getNewIndex(a.list,a.itemSelector),d=e.getNewItemPrefix(a.htmlFieldPrefix,a.property,i),o="function"==typeof a.newItemUrl?a.newItemUrl():a.newItemUrl;o.indexOf("?")<0&&(o+="?"),t.get(o+"&htmlFieldPrefix="+d,function(n){if("table"===a.listType)a.list.find("tbody").append(n),a.list.find(a.itemSelector+":last").append("<td class='delete-cell'>");else{var d=a.list.find(a.itemSelector+":last");d.length>0?d.after(n):a.list.prepend(n)}var o=t(a.itemSelector+":last",a.list),s=e.getIndexName(a.htmlFieldPrefix,a.property);e.appendRemoveAndIndex(o,i,s,a),t.validator&&t.validator.unobtrusive&&t.validator.unobtrusive.parseDynamicContent&&t.validator.unobtrusive.parseDynamicContent(o),a.itemAdded&&a.itemAdded(o),a.addButton.prop("disabled",!1)}).fail(function(t){if(401===t.status){var e="Your session has timed out. Please refresh the page and try again.";console&&console.log?console.log(e):alert(e)}})},removeItem:function(t,e){if(!e.removeConfirmation||confirm(e.removeConfirmation)){var n=$(t);e.itemRemoved&&e.itemRemoved(n),n.remove()}},appendRemoveAndIndex:function(n,a,i,d){var o=e.parseTemplate("removeItem",d),s='<input type="hidden" name="'+i+'" class="index" value="'+a+'" />',l=o+s;"table"===d.listType?n.find("td.delete-cell").append(l):n.append(l),t(".delete-item",n).click(function(t){t.preventDefault(),e.removeItem(n,d)})},getBaseItemPrefix:function(t,e){var n=t;return""!==n&&(n+="."),n+=e},getNewItemPrefix:function(t,n,a){return e.getBaseItemPrefix(t,n)+"["+a+"]"},getIndexName:function(t,n){return e.getBaseItemPrefix(t,n)+".Index"},getNewIndex:function(e,n){var a=t(n,e);if(0===a.length)return 0;var i=0;return a.each(function(){var e=parseInt(t("input.index",t(this)).val());isNaN(e)&&(e=0),i=Math.max(i,e)}),i+1},getTemplate:function(t,e){return e.templates[e.listType][t]},parseTemplate:function(t,n){var a=e.getTemplate(t,n);return Object.keys(n).forEach(function(t){a=a.replace("{"+t+"}",n[t]||"")}),a}},n={init:function(n){return n=t.extend({},t.fn.dynamiclist.defaults,n),this.each(function(){var a=t(this),i=a.data("dynamiclist");if(n.list=a,!i){a.wrap(e.parseTemplate("container",n)),a.addClass("dynamic-list"),n.selector=a.selector,"table"===n.listType&&(t("thead tr",a).append("<th></th>"),t("tbody tr",a).append("<td class='delete-cell'></td>"),t("tfoot tr",a).append("<td></td>")),t(n.itemSelector,a).each(function(a){var i=e.getIndexName(n.htmlFieldPrefix,n.property);e.appendRemoveAndIndex(t(this),a,i,n)});var d=e.parseTemplate("addItem",n);if("table"===n.listType){var o=a.find("thead td, thead th").length,s=a.find("tfoot");0===s.length&&(a.append("<tfoot></tfoot>"),s=a.find("tfoot")),s.append('<tr><td colspan="'+o+'">'+d+"</td></tr>")}else a.append(d);(n.addButton=a.find(".add-item")).click(function(t){e.addItem(t,n)}),a.data("dynamiclist",n),n.itemAdded&&$(n.itemSelector,a).each(function(t,e){n.itemAdded(e)})}})},options:function(e){return this.each(function(){var n=t(this),a=n.data("dynamiclist")||{};e=t.extend({},a,e),n.dynamiclist("destroy").dynamiclist("init",e)})},add:function(){return this.each(function(){var n=t(this);e.addItem(null,n.data("dynamiclist"))})},remove:function(t){var n=$(t),a=$(t).parents(".dynamic-list"),i=a.data("dynamiclist");e.removeItem(n,i)},destroy:function(){return this.each(function(){t(this).removeData("dynamiclist")})}};t.fn.dynamiclist=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.dynamiclist"):n.init.apply(this,arguments)},t.fn.dynamiclist.defaults={itemSelector:".item",addLabel:"Add",removeLabel:"Remove",htmlFieldPrefix:"",property:"Items",newItemUrl:"NewItem",listType:"list",itemAdded:function(t){},itemRemoved:function(t){},removeConfirmation:null,templates:{table:{container:"<div class='dynamic-list-container'></div>",addItem:'<div class="add-item-container"><button class="add-item">{addLabel}</button></div>',removeItem:'<button type="button" class="delete-item">{removeLabel}</button>'},list:{container:"<div class='dynamic-list-container'></div>",addItem:'<li class="add-item-container"><button class="add-item">{addLabel}</button></li>',removeItem:'<button type="button" class="delete-item">{removeLabel}</button>'},div:{container:"<div class='dynamic-list-container'></div>",addItem:'<div class="add-item-container"><button class="add-item">{addLabel}</button></div>',removeItem:'<button type="button" class="delete-item">{removeLabel}</button>'}}}}(jQuery);
//# sourceMappingURL=jquery.dynamiclist.min.js.map
